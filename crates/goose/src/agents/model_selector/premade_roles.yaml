# Pre-made AutoPilot roles with default rules
# These define the default behaviors for common roles
# Users must specify the provider and model in their config.yaml

roles:
  # Lead model - high-capability model for initial turns and failure recovery
  - role: "lead"
    rules:
      triggers:
        # Triggers at conversation start AND on consecutive failures
        first_turn: true  # Trigger on first turn
        consecutive_failures: 2  # Same as GOOSE_LEAD_FAILURE_THRESHOLD default
        source: "any"  # Can trigger on both human (start) and machine (failures)
      active_turns: 3  # Same as GOOSE_LEAD_TURNS default (initial) and GOOSE_LEAD_FALLBACK_TURNS for failures
      priority: 30  # Highest priority to ensure it always triggers first
        
  - role: "second-opinion"
    rules:
      triggers:
        keywords: ["help"]
        match_type: "any"
        after_tool_use: true
        source: "human"
      active_turns: 5
      priority: 5  
  
  # Deep reasoning and analysis
  - role: "deep-thinker"
    rules:
      triggers:
        keywords: ["think", "reason", "analyze", "explain why", "how does", "what if"]
        match_type: "any"
        complexity_threshold: "high"
        source: "human"  # Only trigger on human messages
      active_turns: 3
      priority: 10

  # Consult the oracle
  - role: "oracle"
    rules:
      triggers:
        keywords: ["think", "reason", "analyze", "explain why", "what if"]
        match_type: "any"
        complexity_threshold: "medium"
        source: "human"  # Only trigger on human messages
      active_turns: 5
      priority: 15

  # Consult the planner
  - role: "planner"
    rules:
      triggers:
        keywords: ["think", "plan", "help me", "look at", "consider"]
        match_type: "any"
        complexity_threshold: "low"
        source: "any"  # Only trigger on human messages
      active_turns: 3
      priority: 5



  # Code debugging and error recovery
  - role: "debugger"
    rules:
      triggers:
        keywords: ["error", "bug", "broken", "failed", "exception"]
        match_type: "any"
        on_failure: true
        source: "any"  # Can trigger on both human and machine failures
      active_turns: 2
      priority: 15  # High priority for error handling

  # Code implementation specialist
  - role: "coder"
    rules:
      triggers:
        keywords: ["implement", "code", "function", "class", "refactor", "optimize"]
        match_type: "any"
        after_tool_use: true
        source: "human"
      active_turns: 2
      priority: 8

  # Verification and review
  - role: "reviewer"
    rules:
      triggers:
        keywords: ["check", "verify", "review", "validate", "test", "correct"]
        match_type: "any"
        consecutive_tools: 12  # After many changes
        source: "any"  # Can be triggered by human request OR after lots of tool use
      active_turns: 2
      priority: 6

  # Help and guidance specialist
  - role: "helper"
    rules:
      triggers:
        keywords: ["help", "assist", "guide", "explain", "teach", "how to"]
        match_type: "any"
        source: "human"
      active_turns: 5
      priority: 5

  # Math and calculations
  - role: "mathematician"
    rules:
      triggers:
        keywords: ["calculate", "solve", "equation", "math", "formula", "compute"]
        match_type: "any"
        complexity_threshold: "medium"
        source: "human"
      active_turns: 1
      priority: 7

  # Creative brainstorming
  - role: "creative"
    rules:
      triggers:
        keywords: ["idea", "brainstorm", "creative", "innovate", "design", "imagine"]
        match_type: "any"
        source: "human"
      active_turns: 5
      priority: 4

  # Quick responses for simple queries
  - role: "quick-responder"
    rules:
      triggers:
        complexity_threshold: "low"
        source: "human"
      active_turns: 0
      priority: 2

  # Research and fact-checking
  - role: "researcher"
    rules:
      triggers:
        keywords: ["research", "find", "search", "lookup", "fact", "source", "reference"]
        match_type: "any"
        source: "human"
      active_turns: 3
      priority: 6

  # System recovery after multiple failures
  - role: "recovery-specialist"
    rules:
      triggers:
        consecutive_failures: 2  # After 2 consecutive tool failures
        source: "machine"  # Only triggers on machine-generated failures
      active_turns: 10
      priority: 20  # Very high priority
  
  # Autonomous work reviewer - kicks in after lots of machine work
  - role: "work-reviewer"
    rules:
      triggers:
        tools_since_human: 5  # After 5+ tools used since last human input
        source: "machine"  # Only when machine is active
      active_turns: 8
      priority: 12
      
  # Progress checker - ensures the machine isn't going off track
  - role: "progress-checker"
    rules:
      triggers:
        machine_messages_without_human: 4  # After 4+ consecutive machine messages
        source: "machine"
      active_turns: 5
      priority: 11
      
  # Intensive work monitor - for when lots of tool use is happening
  - role: "intensive-work-monitor"
    rules:
      triggers:
        consecutive_tools: 10  # 10+ tools in a row
        messages_since_human: 6  # AND been working for 6+ messages
        source: "machine"
      active_turns: 10
      priority: 14
        
